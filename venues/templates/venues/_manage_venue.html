<div class="container mt-5" id="manage-venue-form">
    <form method="POST" enctype="multipart/form-data" class="venue-form-card" action = "{% url 'submit_venue_update' venue.id %}">
        {% csrf_token %}

        <!-- Venue Basic Info -->
        <div class="grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div>
                <label for="name">Venue Name</label>
                <input type="text" name="name" id="name" value="{{ venue.name }}" class="form-input" required>
            </div>
            <div>
                <label for="kind">Type</label>
                <select name="kind" id="kind" class="form-input">
                    {% for key, value in venue.VENUE_TYPES %}
                        <option value="{{ key }}" {% if venue.kind == key %}selected{% endif %}>{{ value }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <!-- Location & Contact -->
        <div>
            <label for="location">Location</label>
            <input type="text" name="location" id="location" value="{{ venue.location }}" class="form-input" required>
        </div>
        <div class="grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div>
                <label for="email">Email</label>
                <input type="email" name="email" id="email" value="{{ venue.email }}" class="form-input">
            </div>
            <div>
                <label for="phone">Phone</label>
                <input type="text" name="phone" id="phone" value="{{ venue.phone }}" class="form-input">
            </div>
        </div>

        <!-- Description -->
        <div>
            <label for="description">Description</label>
            <textarea name="description" id="description" rows="4" class="form-input">{{ venue.description }}</textarea>
        </div>

        <!-- Availability & Full Status -->
        <div class="grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div>
                <label for="available_tables">Available Tables</label>
                <input type="number" name="available_tables" id="available_tables" value="{{ venue.available_tables }}" min="0" class="form-input">
            </div>
        </div>

        {% comment %} Image Modal {% endcomment %}
        <div id="imageModal" class="image-modal">
            <button type="button" class="close-btn">&times;</button>
            <img src="" alt="Full Preview">
        </div>

        <!-- Venue Images Upload -->
        <div class="file-upload-group">
            <label class="custom-file-btn">
                Select Venue Images
                <input type="file" name="venue_images" id="venue_images" multiple hidden>
            </label>
            <div id="venue-preview" class="file-preview">
                {% for img in venue.images.all %}
                    <div class="thumb-wrapper" data-existing="true" data-id="{{ img.id }}">
                        <img src="{{ img.image.url }}" width="80" style="margin:2px; border-radius:4px;">
                        <button type="button" class="remove-btn">&times;</button>
                        <input type="hidden" name="remove_venue_images" value="" disabled>
                    </div>
                {% empty %}
                    No files selected
                {% endfor %}
            </div>
        </div>

        <!-- Menu Images Upload -->
        <div class="file-upload-group">
            <label class="custom-file-btn">
                Select Menu Images
                <input type="file" name="menu_images" id="menu_images" multiple hidden>
            </label>
            <div id="menu-preview" class="file-preview">
                {% for img in venue.menu_images.all %}
                    <div class="thumb-wrapper" data-existing="true" data-id="{{ img.id }}">
                        <img src="{{ img.image.url }}" width="80" style="margin:2px; border-radius:4px;">
                        <button type="button" class="remove-btn">&times;</button>
                        <input type="hidden" name="remove_menu_images" value="" disabled>
                    </div>
                {% empty %}
                    No files selected
                {% endfor %}
            </div>
        </div>
        
        <!-- Submit Button -->
        <div class="text-center">
            <button type="submit" class="btn-edit-status">Submit for Approval</button>
        </div>
    </form>
</div>

<style>
.thumb-wrapper {
    display: inline-block;
    position: relative;
}
.remove-btn {
    position: absolute;
    top: 0;
    right: 0;
    background: rgba(255,0,0,0.7);
    border: none;
    color: white;
    font-weight: bold;
    border-radius: 50%;
    cursor: pointer;
    width: 18px;
    height: 18px;
    line-height: 14px;
    padding: 0;
}
</style>